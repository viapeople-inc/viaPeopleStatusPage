<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>viaPeople System Status</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body { font-family: Arial; margin: 0; background: #f7f7f7; }
.header { background: #0d6efd; color: white; padding: 20px; text-align: center; }
.status-box { margin: 20px auto; max-width: 700px; background: white; padding: 20px; border-radius: 8px; }
.indicator { font-size: 22px; font-weight: bold; margin-bottom: 10px; }
.green { color: #28a745; }
.yellow { color: #ffc107; }
.red { color: #dc3545; }
.service { border-top: 1px solid #eee; padding: 10px 0; }
.last-updated { font-size: 12px; color: #666; margin-top: 20px; }
</style>
</head>
<body>

<div class="header">
  <h1>viaPeople Status</h1>
  <p>Live system health and availability</p>
</div>

<div class="status-box">
  <div id="overallStatus" class="indicator">Loading...</div>
  <div id="services"></div>
  <div id="updated" class="last-updated"></div>
</div>

<script>
async function loadStatus() {
  try {
    const data = await fetch('status.json?cache=' + Date.now()).then(r => r.json());

    // Overall Status
    const overall = document.getElementById('overallStatus');
    overall.textContent = data.overall.message;
    overall.className = "indicator " + data.overall.level;

    // Services
    const svc = document.getElementById('services');
    svc.innerHTML = "";
    data.services.forEach(s => {
      svc.innerHTML += `
        <div class="service">
          <strong>${s.name}</strong><br>
          <span class="${s.level}">${s.message}</span>
        </div>`;
    });

    // Timestamp
    document.getElementById('updated').textContent =
      "Last updated: " + new Date(data.updated).toLocaleString();
  }
  catch (e) {
    document.getElementById('overallStatus').innerHTML =
      `<span class="red">Unable to load status.</span>`;
  }
}

loadStatus();
setInterval(loadStatus, 30000); // Refresh every 30 seconds
</script>

</body>
</html>
